<p><img src="/assets/images/2024-08-28-go-grpc-bin/banner.png" alt="banner" /></p>

<p>Github repo: <a href="https://github.com/tiagomelo/go-grpc-bin">https://github.com/tiagomelo/go-grpc-bin</a></p>

<p>Docker official image: <a href="https://hub.docker.com/r/tiagoharris/go-grpc-bin">https://hub.docker.com/r/tiagoharris/go-grpc-bin</a></p>

<p><em>check out my other open source projects <a href="https://tiagomelo.info/opensource/">here</a></em></p>

<h1 id="go-grpc-bin">go-grpc-bin</h1>

<p>A <a href="https://grpc.io">gRPC</a> server written in <a href="https://go.dev">Go</a> that provides a set of utilities that are useful for testing and experimenting with <a href="https://grpc.io">gRPC</a>, such as echoing messages, simulating errors, and streaming responses.</p>

<p>Official <a href="https://docker.com">Docker</a> image: <a href="https://hub.docker.com/r/tiagoharris/go-grpc-bin">https://hub.docker.com/r/tiagoharris/go-grpc-bin</a></p>

<h2 id="available-grpc-services">available gRPC Services</h2>

<ul>
  <li>
    <p><strong>Echo:</strong><br />
Returns the received message back to the client.</p>
  </li>
  <li>
    <p><strong>GetMetadata:</strong><br />
Retrieves the metadata (headers) from the incoming context and returns it.</p>
  </li>
  <li>
    <p><strong>StatusCode:</strong><br />
Simulates returning a specific status code. If the status code is an error, it returns an error with that code.</p>
  </li>
  <li>
    <p><strong>StreamingEcho:</strong><br />
Sends multiple responses back to the client, simulating a server-side streaming RPC.</p>
  </li>
  <li>
    <p><strong>BidirectionalEcho:</strong><br />
Allows both the client and server to send messages in a bidirectional streaming RPC.</p>
  </li>
  <li>
    <p><strong>DelayedResponse:</strong><br />
Simulates a delay before returning the response.</p>
  </li>
  <li>
    <p><strong>Upload:</strong><br />
Receives a stream of binary data and simulates an upload operation.</p>
  </li>
  <li>
    <p><strong>Download:</strong><br />
Sends a stream of binary data back to the client, simulating a file download.</p>
  </li>
  <li>
    <p><strong>SimulateError:</strong><br />
Simulates an error based on the request.</p>
  </li>
  <li>
    <p><strong>Mirror:</strong><br />
Echoes back the received message and metadata.</p>
  </li>
  <li>
    <p><strong>Transform:</strong><br />
Processes the input string according to a specified transformation type (e.g., reversing the string).</p>
  </li>
  <li>
    <p><strong>CompressionTest:</strong><br />
Simulates compression by compressing the data using gzip before returning it.</p>
  </li>
</ul>

<h2 id="running-the-server">running the server</h2>

<h3 id="docker">docker</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run --rm -p &lt;PORT&gt;:&lt;PORT&gt; tiagoharris/go-grpc-bin -p &lt;PORT&gt;
</code></pre></div></div>

<h3 id="locally">locally</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make run PORT=&lt;PORT&gt;
</code></pre></div></div>

<h2 id="example-grpc-requests">example gRPC requests</h2>

<h3 id="using-grpcurl">using <a href="https://github.com/fullstorydev/grpcurl">grpcurl</a></h3>

<ul>
  <li><strong>Echo:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"message": "Hello, gRPC!"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/Echo
{
"message": "Hello, gRPC!"
}
</code></pre></div>    </div>
  </li>
  <li><strong>GetMetadata:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -H "custom-header: value" -d '{}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/GetMetadata
{
"metadata": {
  ":authority": "&lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt;",
  "content-type": "application/grpc",
  "custom-header": "value",
  "grpc-accept-encoding": "gzip",
  "user-agent": "grpcurl/1.9.1 grpc-go/1.61.0"
}
}
</code></pre></div>    </div>
  </li>
  <li><strong>StatusCode:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"code": 3}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/StatusCode
ERROR:
  Code: InvalidArgument
  Message: Simulated error
</code></pre></div></div>

<ul>
  <li><strong>StreamingEcho:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"message": "Hello, Streaming!"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/StreamingEcho
{
  "message": "0: Hello, Streaming!"
}
{
  "message": "1: Hello, Streaming!"
}
{
  "message": "2: Hello, Streaming!"
}
{
  "message": "3: Hello, Streaming!"
}
{
  "message": "4: Hello, Streaming!"
}
</code></pre></div></div>

<ul>
  <li><strong>BidirectionalEcho:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d @ &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/BidirectionalEcho
{ "message": "message one" }    
{
  "message": "message one"
}
{ "message": "message two" }        
{
  "message": "message two"
}
{ "message": "message three" }
{
  "message": "message three"
}
</code></pre></div></div>

<ul>
  <li><strong>DelayedResponse:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ time grpcurl -plaintext -d '{"message": "Wait for it...", "delaySeconds": "5"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/DelayedResponse
{
  "message": "Wait for it..."
}

real	0m5.029s
user	0m0.013s
sys	0m0.011s
</code></pre></div></div>

<ul>
  <li><strong>Upload:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"data": "Q2h1bmsgMQ=="}' -d '{"data": "Q2h1bmsgMg=="}' -d '{"data": "Q2h1bmsgMw=="}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/Upload
{
  "message": "Upload completed"
}
</code></pre></div></div>

<ul>
  <li><strong>Download:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ time grpcurl -plaintext -d '{"filename": "example.txt"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/Download
{
  "data": "VGhpcyA="
}
{
  "data": "aXMgc28="
}
{
  "data": "bWUgdGU="
}
{
  "data": "c3QgZGE="
}
{
  "data": "dGEgZm8="
}
{
  "data": "ciBkb3c="
}
{
  "data": "bmxvYWQ="
}
{
  "data": "Lg=="
}

real	0m4.040s
user	0m0.016s
sys	0m0.016s
</code></pre></div></div>

<ul>
  <li><strong>SimulateError:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"code": 13, "message": "Simulated internal error"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/SimulateError
ERROR:
  Code: Internal
  Message: Simulated internal error
</code></pre></div></div>

<ul>
  <li><strong>Mirror:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -H "custom-header: value" -d '{"message": "Echo this back!"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/Mirror
{
  "message": "Echo this back!",
  "metadata": {
    ":authority": "&lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt;",
    "content-type": "application/grpc",
    "custom-header": "value",
    "grpc-accept-encoding": "gzip",
    "user-agent": "grpcurl/1.9.1 grpc-go/1.61.0"
  }
}
</code></pre></div></div>

<ul>
  <li><strong>Transform:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"input": "reverse this", "transformation_type": "reverse"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/Transform
{
  "output": "siht esrever"
}
</code></pre></div></div>

<ul>
  <li><strong>CompressionTest:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ grpcurl -plaintext -d '{"data": "Compress this data"}' &lt;SERVER_HOST&gt;:&lt;SERVER_PORT&gt; grpcbin.GRPCBin/CompressionTest
{
  "compressedData": "H4sIAAAAAAAA/3LOzy0oSi0uVijJyCxWSEksSQQEAAD//5A1G6cSAAAA"
}
</code></pre></div></div>

<h3 id="using-custom-go-client">using custom <a href="https://go.dev">Go</a> client</h3>

<ul>
  <li><strong>Echo:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/echo/echo.go --serverHost=localhost:4444
echo response: Hello, gRPC!
</code></pre></div></div>

<ul>
  <li><strong>GetMetadata:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/get_metadata/get_metadata.go --serverHost=localhost:4444
metadata response: map[:authority:localhost:4444 content-type:application/grpc test-key:test-value user-agent:grpc-go/1.65.0]
</code></pre></div></div>

<ul>
  <li><strong>StatusCode:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/status_code/status_code.go --serverHost=localhost:4444
StatusCode response: Simulated error
</code></pre></div></div>

<ul>
  <li><strong>StreamingEcho:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/streaming_echo/streaming_echo.go --serverHost=localhost:4444
StreamingEcho response: 0: Hello, Streaming!
StreamingEcho response: 1: Hello, Streaming!
StreamingEcho response: 2: Hello, Streaming!
StreamingEcho response: 3: Hello, Streaming!
StreamingEcho response: 4: Hello, Streaming!
</code></pre></div></div>

<ul>
  <li><strong>BidirectionalEcho:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/bidirectional_echo/bidirectional_echo.go --serverHost=localhost:4444
BidirectionalEcho response: First message
BidirectionalEcho response: Second message
BidirectionalEcho response: Third message
</code></pre></div></div>

<ul>
  <li><strong>DelayedResponse:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ time go run examples/delayed_response/delayed_response.go --serverHost=localhost:4444
DelayedResponse: Delayed Hello!

real	0m3.804s
user	0m0.383s
sys	0m0.367s
</code></pre></div></div>

<ul>
  <li><strong>Upload:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ time go run examples/upload/upload.go --serverHost=localhost:4444
Upload reply: Upload completed

real	0m3.097s
user	0m0.359s
sys	0m0.396s
</code></pre></div></div>

<ul>
  <li><strong>Download:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ time go run examples/download/download.go --serverHost=localhost:4444
Downloaded file data: This is some test data for download.

real	0m4.656s
user	0m0.381s
sys	0m0.325s
</code></pre></div></div>

<ul>
  <li><strong>SimulateError:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/simulate_error/simulate_error.go --serverHost=localhost:4444
SimulateError: Simulated internal server error
</code></pre></div></div>

<ul>
  <li><strong>Mirror:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/mirror/mirror.go --serverHost=localhost:4444
Mirror response: Hello, Mirror!
Mirror metadata: map[:authority:localhost:4444 content-type:application/grpc key:value user-agent:grpc-go/1.65.0]
</code></pre></div></div>

<ul>
  <li><strong>Transform:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/transform/transform.go --serverHost=localhost:4444
Transform response: !mrofsnarT ,olleH
</code></pre></div></div>

<ul>
  <li><strong>CompressionTest:</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run examples/compression/compression.go --serverHost=localhost:4444
Uncompressed data: Hello, Compression!
</code></pre></div></div>

<h2 id="unit-tests">unit tests</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make test
</code></pre></div></div>

<h2 id="coverage">coverage</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make coverage
</code></pre></div></div>

<h2 id="contributing">contributing</h2>

<p>contributions are welcome! Feel free to open issues or submit pull requests.</p>
